 ---------------------------------------------------------------
--  created:   2010.3.17
--  author:    ld
--  内容：任务脚本文件
---------------------------------------------------------------
----	脚本任务列表：by xzy
----	9706	A类日常任务：自由港生活
----	10117	元宝换金任务：墨丘利的启示录
----	12590	元宝换金任务：墨丘利的福音书
----	1st edition:	2010.6.8
---------------------------------------------------------------
TaskList[9706] = --  日常-自由港生活-主任务
{
	levelweight =
    {
        {level=10,tp1=250,tp2=0,tp3=100,tp4=150,tp5=0,tp6=100,tp7=100,tp8=100,tp9=100,tp10=0,tp11=100,tp12=0,tp13=0,tp14=0,tp15=0,tp16=0,tp17=0,tp18=0,tp19=0,tp20=0,},
        {level=20,tp1=250,tp2=20,tp3=100,tp4=0,tp5=0,tp6=230,tp7=100,tp8=100,tp9=100,tp10=0,tp11=100,tp12=0,tp13=0,tp14=0,tp15=0,tp16=0,tp17=0,tp18=0,tp19=0,tp20=0,},
        {level=30,tp1=210,tp2=20,tp3=100,tp4=50,tp5=0,tp6=200,tp7=100,tp8=100,tp9=100,tp10=10,tp11=100,tp12=10,tp13=0,tp14=0,tp15=0,tp16=0,tp17=0,tp18=0,tp19=0,tp20=0,},
        {level=40,tp1=160,tp2=20,tp3=100,tp4=50,tp5=0,tp6=200,tp7=100,tp8=100,tp9=100,tp10=10,tp11=100,tp12=10,tp13=10,tp14=0,tp15=0,tp16=0,tp17=40,tp18=0,tp19=0,tp20=0,},
        {level=50,tp1=130,tp2=20,tp3=80,tp4=50,tp5=0,tp6=200,tp7=100,tp8=100,tp9=100,tp10=10,tp11=100,tp12=10,tp13=10,tp14=10,tp15=10,tp16=0,tp17=40,tp18=30,tp19=0,tp20=0,},
        {level=60,tp1=120,tp2=20,tp3=70,tp4=50,tp5=0,tp6=200,tp7=100,tp8=100,tp9=100,tp10=10,tp11=100,tp12=10,tp13=10,tp14=10,tp15=10,tp16=10,tp17=40,tp18=40,tp19=0,tp20=0,},
        {level=70,tp1=120,tp2=20,tp3=60,tp4=50,tp5=0,tp6=200,tp7=100,tp8=100,tp9=100,tp10=10,tp11=100,tp12=10,tp13=10,tp14=10,tp15=10,tp16=10,tp17=40,tp18=50,tp19=0,tp20=0,},
    },
	tplib =
    {
        {tp="tp1",order=1,id=9707,num=1,note="task",startlv=10,endlv=200,},
        {tp="tp1",order=2,id=9708,num=1,note="task",startlv=10,endlv=200,},
        {tp="tp1",order=3,id=9709,num=1,note="task",startlv=10,endlv=200,},
        {tp="tp1",order=4,id=9710,num=1,note="task",startlv=10,endlv=200,},
        {tp="tp1",order=5,id=9711,num=1,note="task",startlv=10,endlv=200,},
        {tp="tp1",order=6,id=9712,num=1,note="task",startlv=10,endlv=200,},
        {tp="tp1",order=7,id=9713,num=1,note="task",startlv=10,endlv=200,},
        {tp="tp1",order=8,id=9714,num=1,note="task",startlv=10,endlv=200,},
        {tp="tp1",order=9,id=9715,num=1,note="task",startlv=10,endlv=200,},
        {tp="tp1",order=10,id=9716,num=1,note="task",startlv=10,endlv=200,},
        {tp="tp1",order=11,id=9717,num=1,note="task",startlv=10,endlv=200,},
        {tp="tp1",order=12,id=9718,num=1,note="task",startlv=10,endlv=200,},
        {tp="tp1",order=13,id=9719,num=1,note="task",startlv=10,endlv=200,},
        {tp="tp1",order=14,id=9720,num=1,note="task",startlv=50,endlv=200,},
        {tp="tp1",order=15,id=9721,num=1,note="task",startlv=50,endlv=200,},
        {tp="tp1",order=16,id=9722,num=1,note="task",startlv=50,endlv=200,},
        {tp="tp1",order=17,id=9723,num=1,note="task",startlv=50,endlv=200,},
        {tp="tp1",order=18,id=9724,num=1,note="task",startlv=50,endlv=200,},
        {tp="tp1",order=19,id=9725,num=1,note="task",startlv=50,endlv=200,},
        {tp="tp1",order=20,id=9726,num=1,note="task",startlv=50,endlv=200,},
        {tp="tp1",order=21,id=11166,num=1,note="task",startlv=10,endlv=200,},
        {tp="tp1",order=22,id=11500,num=1,note="task",startlv=45,endlv=200,},
        {tp="tp2",order=30,id=5718,id2=27575,num=1,note="wish",startlv=20,endlv=120,},
        {tp="tp3",order=31,id=9727,num=1,note="site",startlv=10,endlv=120,},
        {tp="tp3",order=32,id=9728,num=1,note="site",startlv=10,endlv=120,},
        {tp="tp3",order=33,id=9729,num=1,note="site",startlv=10,endlv=120,},
        {tp="tp4",order=50,id=21,num=5,note="monster",startlv=10,endlv=19,},
        {tp="tp4",order=51,id=6623,num=5,note="monster",startlv=10,endlv=19,},
        {tp="tp4",order=52,id=22,num=5,note="monster",startlv=17,endlv=19,},
        {tp="tp4",order=53,id=24,num=5,note="monster",startlv=17,endlv=19,},
        {tp="tp4",order=54,id=16013,num=5,note="monster",startlv=17,endlv=19,},
        {tp="tp4",order=55,id=27216,num=3,note="monster",startlv=30,endlv=39,},
        {tp="tp4",order=56,id=5788,num=8,note="monster",startlv=40,endlv=49,},
        {tp="tp4",order=57,id=5783,num=8,note="monster",startlv=40,endlv=49,},
        {tp="tp4",order=58,id=27217,num=3,note="monster",startlv=50,endlv=59,},
        {tp="tp4",order=59,id=23,num=10,note="monster",startlv=60,endlv=69,},
        {tp="tp4",order=60,id=23,num=10,note="monster",startlv=60,endlv=69,},
        {tp="tp4",order=61,id=16033,num=10,note="monster",startlv=65,endlv=80,},
        {tp="tp4",order=62,id=16034,num=10,note="monster",startlv=65,endlv=80,},
        {tp="tp4",order=63,id=16035,num=10,note="monster",startlv=65,endlv=80,},
        {tp="tp4",order=64,id=16036,num=10,note="monster",startlv=65,endlv=80,},
        {tp="tp6",order=120,id=4534,num=1,note="item",startlv=1,endlv=21,},
        {tp="tp6",order=121,id=4535,num=1,note="item",startlv=10,endlv=30,},
        {tp="tp6",order=122,id=4536,num=1,note="item",startlv=20,endlv=40,},
        {tp="tp6",order=123,id=4537,num=1,note="item",startlv=30,endlv=50,},
        {tp="tp6",order=124,id=4538,num=1,note="item",startlv=40,endlv=60,},
        {tp="tp6",order=125,id=4538,num=2,note="item",startlv=50,endlv=120,},
        {tp="tp6",order=126,id=4540,num=1,note="item",startlv=1,endlv=21,},
        {tp="tp6",order=127,id=4541,num=1,note="item",startlv=10,endlv=30,},
        {tp="tp6",order=128,id=4542,num=1,note="item",startlv=20,endlv=40,},
        {tp="tp6",order=129,id=4543,num=1,note="item",startlv=30,endlv=50,},
        {tp="tp6",order=130,id=4544,num=1,note="item",startlv=40,endlv=60,},
        {tp="tp6",order=131,id=4544,num=2,note="item",startlv=50,endlv=120,},
        {tp="tp6",order=132,id=34664,num=1,note="item",startlv=1,endlv=31,},
        {tp="tp6",order=133,id=34665,num=1,note="item",startlv=30,endlv=60,},
        {tp="tp6",order=134,id=34666,num=1,note="item",startlv=50,endlv=120,},
        {tp="tp6",order=135,id=5832,num=1,note="item",startlv=1,endlv=31,},
        {tp="tp6",order=136,id=5833,num=1,note="item",startlv=30,endlv=60,},
        {tp="tp6",order=137,id=5834,num=1,note="item",startlv=50,endlv=120,},
        {tp="tp7",order=150,id=11687,num=1,note="item",startlv=10,endlv=40,},
        {tp="tp7",order=151,id=12340,num=1,note="item",startlv=10,endlv=40,},
        {tp="tp7",order=152,id=12341,num=1,note="item",startlv=20,endlv=50,},
        {tp="tp7",order=153,id=12342,num=1,note="item",startlv=30,endlv=120,},
        {tp="tp7",order=154,id=7043,num=1,note="item",startlv=10,endlv=120,},
        {tp="tp7",order=155,id=7041,num=1,note="item",startlv=10,endlv=120,},
        {tp="tp7",order=156,id=7044,num=1,note="item",startlv=10,endlv=120,},
        {tp="tp7",order=157,id=7045,num=1,note="item",startlv=10,endlv=120,},
        {tp="tp7",order=158,id=7042,num=1,note="item",startlv=10,endlv=120,},
        {tp="tp7",order=159,id=17440,num=1,note="item",startlv=10,endlv=120,},
        {tp="tp7",order=160,id=19034,num=1,note="item",startlv=10,endlv=30,},
        {tp="tp7",order=161,id=19035,num=1,note="item",startlv=10,endlv=30,},
        {tp="tp7",order=162,id=19036,num=1,note="item",startlv=10,endlv=30,},
        {tp="tp7",order=163,id=19037,num=1,note="item",startlv=10,endlv=120,},
        {tp="tp7",order=164,id=18919,num=1,note="item",startlv=10,endlv=120,},
        {tp="tp7",order=165,id=12234,num=1,note="item",startlv=10,endlv=120,},
        {tp="tp8",order=170,id=17009,num=1,note="item",startlv=10,endlv=29,},
        {tp="tp8",order=171,id=17011,num=1,note="item",startlv=10,endlv=29,},
        {tp="tp8",order=172,id=19062,num=1,note="item",startlv=10,endlv=29,},
        {tp="tp8",order=173,id=17012,num=1,note="item",startlv=10,endlv=29,},
        {tp="tp8",order=174,id=17013,num=1,note="item",startlv=10,endlv=29,},
        {tp="tp8",order=175,id=19063,num=1,note="item",startlv=10,endlv=29,},
        {tp="tp8",order=176,id=17016,num=1,note="item",startlv=20,endlv=39,},
        {tp="tp8",order=177,id=17017,num=1,note="item",startlv=20,endlv=39,},
        {tp="tp8",order=178,id=17018,num=1,note="item",startlv=20,endlv=39,},
        {tp="tp8",order=179,id=23286,num=1,note="item",startlv=20,endlv=39,},
        {tp="tp8",order=180,id=17019,num=1,note="item",startlv=20,endlv=39,},
        {tp="tp8",order=181,id=17020,num=1,note="item",startlv=20,endlv=39,},
        {tp="tp8",order=182,id=17021,num=1,note="item",startlv=20,endlv=39,},
        {tp="tp8",order=183,id=17023,num=1,note="item",startlv=30,endlv=49,},
        {tp="tp8",order=184,id=17024,num=1,note="item",startlv=30,endlv=49,},
        {tp="tp8",order=185,id=17025,num=1,note="item",startlv=30,endlv=49,},
        {tp="tp8",order=186,id=17026,num=1,note="item",startlv=30,endlv=49,},
        {tp="tp8",order=187,id=17027,num=1,note="item",startlv=30,endlv=49,},
        {tp="tp8",order=188,id=17028,num=1,note="item",startlv=30,endlv=49,},
        {tp="tp8",order=189,id=17030,num=1,note="item",startlv=30,endlv=49,},
        {tp="tp8",order=190,id=17039,num=1,note="item",startlv=30,endlv=49,},
        {tp="tp8",order=191,id=17033,num=1,note="item",startlv=40,endlv=120,},
        {tp="tp8",order=192,id=17034,num=1,note="item",startlv=40,endlv=120,},
        {tp="tp8",order=193,id=17035,num=1,note="item",startlv=40,endlv=120,},
        {tp="tp8",order=194,id=23287,num=1,note="item",startlv=40,endlv=120,},
        {tp="tp8",order=195,id=17029,num=1,note="item",startlv=40,endlv=120,},
        {tp="tp8",order=196,id=17036,num=1,note="item",startlv=40,endlv=120,},
        {tp="tp8",order=197,id=17037,num=1,note="item",startlv=40,endlv=120,},
        {tp="tp8",order=198,id=17038,num=1,note="item",startlv=40,endlv=120,},
        {tp="tp8",order=199,id=23867,num=1,note="item",startlv=40,endlv=120,},
        {tp="tp8",order=200,id=21425,num=1,note="item",startlv=10,endlv=29,},
        {tp="tp8",order=201,id=21426,num=1,note="item",startlv=20,endlv=39,},
        {tp="tp8",order=202,id=21427,num=1,note="item",startlv=30,endlv=49,},
        {tp="tp8",order=203,id=21428,num=1,note="item",startlv=40,endlv=59,},
        {tp="tp8",order=204,id=21429,num=1,note="item",startlv=50,endlv=120,},
        {tp="tp8",order=205,id=21430,num=1,note="item",startlv=60,endlv=120,},
        {tp="tp8",order=206,id=16951,num=1,note="item",startlv=10,endlv=29,},
        {tp="tp8",order=207,id=16952,num=1,note="item",startlv=10,endlv=29,},
        {tp="tp8",order=208,id=16972,num=1,note="item",startlv=10,endlv=29,},
        {tp="tp8",order=209,id=16973,num=1,note="item",startlv=10,endlv=29,},
        {tp="tp8",order=210,id=16973,num=1,note="item",startlv=10,endlv=29,},
        {tp="tp8",order=211,id=21438,num=1,note="item",startlv=10,endlv=29,},
        {tp="tp8",order=212,id=16961,num=1,note="item",startlv=20,endlv=39,},
        {tp="tp8",order=213,id=16962,num=1,note="item",startlv=20,endlv=39,},
        {tp="tp8",order=214,id=16980,num=1,note="item",startlv=20,endlv=39,},
        {tp="tp8",order=215,id=16980,num=1,note="item",startlv=20,endlv=39,},
        {tp="tp8",order=216,id=16981,num=1,note="item",startlv=20,endlv=39,},
        {tp="tp8",order=217,id=21439,num=1,note="item",startlv=20,endlv=39,},
        {tp="tp8",order=218,id=16953,num=1,note="item",startlv=30,endlv=49,},
        {tp="tp8",order=219,id=16954,num=1,note="item",startlv=30,endlv=49,},
        {tp="tp8",order=220,id=16992,num=1,note="item",startlv=30,endlv=49,},
        {tp="tp8",order=221,id=16993,num=1,note="item",startlv=30,endlv=49,},
        {tp="tp8",order=222,id=16993,num=1,note="item",startlv=30,endlv=49,},
        {tp="tp8",order=223,id=21099,num=1,note="item",startlv=30,endlv=49,},
        {tp="tp8",order=224,id=21100,num=1,note="item",startlv=30,endlv=49,},
        {tp="tp8",order=225,id=21440,num=1,note="item",startlv=30,endlv=49,},
        {tp="tp8",order=226,id=16959,num=1,note="item",startlv=40,endlv=120,},
        {tp="tp8",order=227,id=16960,num=1,note="item",startlv=40,endlv=120,},
        {tp="tp8",order=228,id=16982,num=1,note="item",startlv=40,endlv=120,},
        {tp="tp8",order=229,id=16983,num=1,note="item",startlv=40,endlv=120,},
        {tp="tp8",order=230,id=16998,num=1,note="item",startlv=40,endlv=120,},
        {tp="tp8",order=231,id=16999,num=1,note="item",startlv=40,endlv=120,},
        {tp="tp8",order=232,id=16999,num=1,note="item",startlv=40,endlv=120,},
        {tp="tp8",order=233,id=21441,num=1,note="item",startlv=40,endlv=120,},
        {tp="tp8",order=234,id=22421,num=1,note="item",startlv=30,endlv=49,},
        {tp="tp8",order=235,id=22422,num=1,note="item",startlv=30,endlv=49,},
        {tp="tp8",order=236,id=22423,num=1,note="item",startlv=30,endlv=49,},
        {tp="tp8",order=237,id=22424,num=1,note="item",startlv=30,endlv=49,},
        {tp="tp8",order=238,id=22425,num=1,note="item",startlv=30,endlv=49,},
        {tp="tp8",order=239,id=22426,num=1,note="item",startlv=30,endlv=49,},
        {tp="tp8",order=240,id=22427,num=1,note="item",startlv=30,endlv=49,},
        {tp="tp8",order=241,id=22428,num=1,note="item",startlv=30,endlv=49,},
        {tp="tp8",order=242,id=22437,num=1,note="item",startlv=40,endlv=59,},
        {tp="tp8",order=243,id=22438,num=1,note="item",startlv=40,endlv=59,},
        {tp="tp8",order=244,id=22439,num=1,note="item",startlv=40,endlv=59,},
        {tp="tp8",order=245,id=22440,num=1,note="item",startlv=40,endlv=59,},
        {tp="tp8",order=246,id=22441,num=1,note="item",startlv=40,endlv=59,},
        {tp="tp8",order=247,id=22442,num=1,note="item",startlv=40,endlv=59,},
        {tp="tp8",order=248,id=22443,num=1,note="item",startlv=40,endlv=59,},
        {tp="tp8",order=249,id=22444,num=1,note="item",startlv=40,endlv=59,},
        {tp="tp8",order=250,id=22453,num=1,note="item",startlv=50,endlv=120,},
        {tp="tp8",order=251,id=22454,num=1,note="item",startlv=50,endlv=120,},
        {tp="tp8",order=252,id=22455,num=1,note="item",startlv=50,endlv=120,},
        {tp="tp8",order=253,id=22456,num=1,note="item",startlv=50,endlv=120,},
        {tp="tp8",order=254,id=22457,num=1,note="item",startlv=50,endlv=120,},
        {tp="tp8",order=255,id=22458,num=1,note="item",startlv=50,endlv=120,},
        {tp="tp8",order=256,id=22459,num=1,note="item",startlv=50,endlv=120,},
        {tp="tp8",order=257,id=22460,num=1,note="item",startlv=50,endlv=120,},
        {tp="tp8",order=258,id=29379,num=1,note="item",startlv=40,endlv=120,},
        {tp="tp8",order=259,id=29385,num=1,note="item",startlv=40,endlv=120,},
        {tp="tp8",order=260,id=29451,num=1,note="item",startlv=40,endlv=59,},
        {tp="tp8",order=261,id=29452,num=1,note="item",startlv=40,endlv=59,},
        {tp="tp8",order=262,id=29453,num=1,note="item",startlv=40,endlv=59,},
        {tp="tp8",order=263,id=29454,num=1,note="item",startlv=40,endlv=59,},
        {tp="tp8",order=264,id=29455,num=1,note="item",startlv=50,endlv=120,},
        {tp="tp8",order=265,id=29456,num=1,note="item",startlv=50,endlv=120,},
        {tp="tp8",order=266,id=29457,num=1,note="item",startlv=50,endlv=120,},
        {tp="tp8",order=267,id=29458,num=1,note="item",startlv=50,endlv=120,},
        {tp="tp8",order=268,id=29479,num=1,note="item",startlv=40,endlv=59,},
        {tp="tp8",order=269,id=29480,num=1,note="item",startlv=40,endlv=59,},
        {tp="tp8",order=270,id=29481,num=1,note="item",startlv=40,endlv=59,},
        {tp="tp8",order=271,id=29482,num=1,note="item",startlv=40,endlv=59,},
        {tp="tp8",order=272,id=29483,num=1,note="item",startlv=50,endlv=120,},
        {tp="tp8",order=273,id=29484,num=1,note="item",startlv=50,endlv=120,},
        {tp="tp8",order=274,id=29485,num=1,note="item",startlv=50,endlv=120,},
        {tp="tp8",order=275,id=29486,num=1,note="item",startlv=50,endlv=120,},
        {tp="tp8",order=276,id=29605,num=1,note="item",startlv=40,endlv=120,},
        {tp="tp8",order=277,id=29612,num=1,note="item",startlv=40,endlv=120,},
        {tp="tp8",order=278,id=29619,num=1,note="item",startlv=40,endlv=120,},
        {tp="tp8",order=279,id=29626,num=1,note="item",startlv=40,endlv=120,},
        {tp="tp8",order=280,id=29633,num=1,note="item",startlv=40,endlv=120,},
        {tp="tp8",order=281,id=29640,num=1,note="item",startlv=40,endlv=120,},
        {tp="tp8",order=282,id=29647,num=1,note="item",startlv=40,endlv=120,},
        {tp="tp8",order=283,id=29654,num=1,note="item",startlv=40,endlv=120,},
        {tp="tp8",order=284,id=29661,num=1,note="item",startlv=40,endlv=120,},
        {tp="tp8",order=285,id=29668,num=1,note="item",startlv=40,endlv=120,},
        {tp="tp8",order=286,id=29675,num=1,note="item",startlv=40,endlv=120,},
        {tp="tp8",order=287,id=29682,num=1,note="item",startlv=40,endlv=120,},
        {tp="tp8",order=288,id=29689,num=1,note="item",startlv=40,endlv=120,},
        {tp="tp8",order=289,id=29696,num=1,note="item",startlv=40,endlv=120,},
        {tp="tp8",order=290,id=29850,num=1,note="item",startlv=40,endlv=120,},
        {tp="tp8",order=291,id=29857,num=1,note="item",startlv=40,endlv=120,},
        {tp="tp8",order=292,id=29864,num=1,note="item",startlv=40,endlv=120,},
        {tp="tp8",order=293,id=29871,num=1,note="item",startlv=40,endlv=120,},
        {tp="tp8",order=294,id=29878,num=1,note="item",startlv=40,endlv=120,},
        {tp="tp8",order=295,id=29885,num=1,note="item",startlv=40,endlv=120,},
        {tp="tp8",order=296,id=29892,num=1,note="item",startlv=40,endlv=120,},
        {tp="tp8",order=297,id=29899,num=1,note="item",startlv=40,endlv=120,},
        {tp="tp8",order=298,id=29906,num=1,note="item",startlv=40,endlv=120,},
        {tp="tp8",order=299,id=29913,num=1,note="item",startlv=40,endlv=120,},
        {tp="tp8",order=300,id=29920,num=1,note="item",startlv=40,endlv=120,},
        {tp="tp8",order=301,id=29927,num=1,note="item",startlv=40,endlv=120,},
        {tp="tp8",order=302,id=29934,num=1,note="item",startlv=40,endlv=120,},
        {tp="tp8",order=303,id=29941,num=1,note="item",startlv=40,endlv=120,},
        {tp="tp8",order=304,id=29948,num=1,note="item",startlv=40,endlv=120,},
        {tp="tp8",order=305,id=29955,num=1,note="item",startlv=40,endlv=120,},
        {tp="tp8",order=306,id=29962,num=1,note="item",startlv=40,endlv=120,},
        {tp="tp8",order=307,id=29969,num=1,note="item",startlv=40,endlv=120,},
        {tp="tp8",order=308,id=29976,num=1,note="item",startlv=40,endlv=120,},
        {tp="tp8",order=309,id=29983,num=1,note="item",startlv=40,endlv=120,},
        {tp="tp8",order=310,id=29990,num=1,note="item",startlv=40,endlv=120,},
        {tp="tp8",order=311,id=30144,num=1,note="item",startlv=40,endlv=120,},
        {tp="tp8",order=312,id=30151,num=1,note="item",startlv=40,endlv=120,},
        {tp="tp8",order=313,id=30158,num=1,note="item",startlv=40,endlv=120,},
        {tp="tp8",order=314,id=30165,num=1,note="item",startlv=40,endlv=120,},
        {tp="tp8",order=315,id=30172,num=1,note="item",startlv=40,endlv=120,},
        {tp="tp8",order=316,id=30179,num=1,note="item",startlv=40,endlv=120,},
        {tp="tp8",order=317,id=30186,num=1,note="item",startlv=40,endlv=120,},
        {tp="tp8",order=318,id=30193,num=1,note="item",startlv=40,endlv=120,},
        {tp="tp8",order=319,id=30200,num=1,note="item",startlv=40,endlv=120,},
        {tp="tp8",order=320,id=30207,num=1,note="item",startlv=40,endlv=120,},
        {tp="tp8",order=321,id=30214,num=1,note="item",startlv=40,endlv=120,},
        {tp="tp8",order=322,id=30221,num=1,note="item",startlv=40,endlv=120,},
        {tp="tp8",order=323,id=30228,num=1,note="item",startlv=40,endlv=120,},
        {tp="tp8",order=324,id=30235,num=1,note="item",startlv=40,endlv=120,},
        {tp="tp8",order=325,id=30242,num=1,note="item",startlv=40,endlv=120,},
        {tp="tp8",order=326,id=30249,num=1,note="item",startlv=40,endlv=120,},
        {tp="tp8",order=327,id=30256,num=1,note="item",startlv=40,endlv=120,},
        {tp="tp8",order=328,id=30263,num=1,note="item",startlv=40,endlv=120,},
        {tp="tp8",order=329,id=30270,num=1,note="item",startlv=40,endlv=120,},
        {tp="tp8",order=330,id=30277,num=1,note="item",startlv=40,endlv=120,},
        {tp="tp8",order=331,id=30284,num=1,note="item",startlv=40,endlv=120,},
        {tp="tp9",order=400,id=9624,num=3,note="item",startlv=10,endlv=39,},
        {tp="tp9",order=401,id=9625,num=3,note="item",startlv=20,endlv=49,},
        {tp="tp9",order=402,id=9626,num=3,note="item",startlv=30,endlv=59,},
        {tp="tp9",order=403,id=9627,num=3,note="item",startlv=40,endlv=120,},
        {tp="tp9",order=404,id=11618,num=10,note="item",startlv=30,endlv=120,},
        {tp="tp9",order=405,id=9627,num=4,note="item",startlv=60,endlv=120,},
        {tp="tp10",order=450,id=27206,num=1,note="item",startlv=20,endlv=200,},
        {tp="tp10",order=451,id=27206,num=2,note="item",startlv=30,endlv=200,},
        {tp="tp10",order=452,id=27206,num=3,note="item",startlv=40,endlv=200,},
        {tp="tp10",order=453,id=27206,num=4,note="item",startlv=50,endlv=200,},
        {tp="tp10",order=454,id=20485,num=1,note="item",startlv=30,endlv=200,},
        {tp="tp10",order=455,id=20486,num=1,note="item",startlv=30,endlv=200,},
        {tp="tp10",order=456,id=9393,num=1,note="item",startlv=30,endlv=200,},
        {tp="tp10",order=457,id=28234,num=2,note="item",startlv=50,endlv=200,},
        {tp="tp10",order=458,id=28235,num=2,note="item",startlv=50,endlv=200,},
        {tp="tp10",order=459,id=28239,num=2,note="item",startlv=50,endlv=200,},
        {tp="tp10",order=460,id=28240,num=2,note="item",startlv=50,endlv=200,},
        {tp="tp11",order=500,id=20323,num=1,note="item",startlv=10,endlv=120,},
        {tp="tp11",order=501,id=20326,num=1,note="item",startlv=10,endlv=120,},
        {tp="tp11",order=502,id=20332,num=1,note="item",startlv=10,endlv=120,},
        {tp="tp11",order=503,id=20336,num=1,note="item",startlv=10,endlv=120,},
        {tp="tp12",order=505,id=9517,num=2,note="item",startlv=10,endlv=120,},
        {tp="tp12",order=506,id=9517,num=3,note="item",startlv=20,endlv=120,},
        {tp="tp12",order=507,id=9517,num=4,note="item",startlv=30,endlv=120,},
        {tp="tp12",order=508,id=9517,num=5,note="item",startlv=40,endlv=120,},
        {tp="tp12",order=509,id=7080,num=2,note="item",startlv=50,endlv=120,},
        {tp="tp12",order=510,id=7080,num=3,note="item",startlv=52,endlv=120,},
        {tp="tp12",order=511,id=7080,num=4,note="item",startlv=55,endlv=120,},
        {tp="tp12",order=512,id=7080,num=5,note="item",startlv=57,endlv=120,},
        {tp="tp12",order=513,id=17065,num=2,note="item",startlv=60,endlv=120,},
        {tp="tp12",order=514,id=17065,num=3,note="item",startlv=62,endlv=120,},
        {tp="tp12",order=515,id=17065,num=4,note="item",startlv=65,endlv=120,},
        {tp="tp12",order=516,id=17065,num=5,note="item",startlv=69,endlv=120,},
        {tp="tp12",order=517,id=7056,num=1,note="item",startlv=30,endlv=120,},
        {tp="tp12",order=518,id=7056,num=2,note="item",startlv=40,endlv=120,},
        {tp="tp12",order=519,id=7056,num=3,note="item",startlv=50,endlv=120,},
        {tp="tp12",order=520,id=7056,num=4,note="item",startlv=55,endlv=120,},
        {tp="tp12",order=521,id=17455,num=1,note="item",startlv=60,endlv=120,},
        {tp="tp12",order=522,id=17455,num=2,note="item",startlv=65,endlv=120,},
        {tp="tp12",order=523,id=17455,num=3,note="item",startlv=69,endlv=120,},
        {tp="tp12",order=524,id=7102,num=2,note="item",startlv=30,endlv=120,},
        {tp="tp12",order=525,id=7102,num=3,note="item",startlv=40,endlv=120,},
        {tp="tp12",order=526,id=7102,num=4,note="item",startlv=50,endlv=120,},
        {tp="tp12",order=527,id=7102,num=3,note="item",startlv=40,endlv=120,},
        {tp="tp12",order=528,id=7102,num=4,note="item",startlv=50,endlv=120,},
        {tp="tp12",order=529,id=7102,num=3,note="item",startlv=40,endlv=120,},
        {tp="tp13",order=530,id=9650,num=1,note="item",startlv=10,endlv=40,},
        {tp="tp13",order=531,id=9650,num=2,note="item",startlv=10,endlv=41,},
        {tp="tp13",order=532,id=9650,num=3,note="item",startlv=10,endlv=42,},
        {tp="tp13",order=533,id=9650,num=4,note="item",startlv=10,endlv=43,},
        {tp="tp13",order=534,id=9650,num=5,note="item",startlv=10,endlv=44,},
        {tp="tp13",order=535,id=9658,num=1,note="item",startlv=40,endlv=45,},
        {tp="tp13",order=536,id=9658,num=2,note="item",startlv=40,endlv=48,},
        {tp="tp13",order=537,id=9658,num=3,note="item",startlv=40,endlv=52,},
        {tp="tp13",order=538,id=9658,num=4,note="item",startlv=40,endlv=55,},
        {tp="tp13",order=539,id=9658,num=5,note="item",startlv=40,endlv=58,},
        {tp="tp13",order=540,id=9664,num=1,note="item",startlv=50,endlv=54,},
        {tp="tp13",order=541,id=9664,num=2,note="item",startlv=50,endlv=59,},
        {tp="tp13",order=542,id=9664,num=3,note="item",startlv=50,endlv=64,},
        {tp="tp13",order=543,id=9664,num=4,note="item",startlv=50,endlv=69,},
        {tp="tp13",order=544,id=9664,num=5,note="item",startlv=50,endlv=74,},
        {tp="tp13",order=545,id=9705,num=1,note="item",startlv=60,endlv=64,},
        {tp="tp13",order=546,id=9705,num=2,note="item",startlv=60,endlv=69,},
        {tp="tp13",order=547,id=9705,num=3,note="item",startlv=60,endlv=74,},
        {tp="tp13",order=548,id=9705,num=4,note="item",startlv=60,endlv=120,},
        {tp="tp13",order=549,id=9705,num=5,note="item",startlv=60,endlv=120,},
        {tp="tp13",order=555,id=11690,num=3,note="item",startlv=10,endlv=40,},
        {tp="tp13",order=556,id=11690,num=4,note="item",startlv=20,endlv=50,},
        {tp="tp13",order=557,id=11690,num=5,note="item",startlv=30,endlv=60,},
        {tp="tp13",order=558,id=12255,num=3,note="item",startlv=40,endlv=70,},
        {tp="tp13",order=559,id=12255,num=4,note="item",startlv=50,endlv=80,},
        {tp="tp13",order=560,id=12255,num=5,note="item",startlv=60,endlv=120,},
        {tp="tp14",order=570,id=21419,num=1,note="item",startlv=10,endlv=40,},
        {tp="tp14",order=571,id=21420,num=1,note="item",startlv=20,endlv=49,},
        {tp="tp14",order=572,id=21421,num=1,note="item",startlv=30,endlv=59,},
        {tp="tp14",order=573,id=21422,num=1,note="item",startlv=40,endlv=69,},
        {tp="tp14",order=574,id=21423,num=1,note="item",startlv=50,endlv=79,},
        {tp="tp14",order=575,id=21423,num=1,note="item",startlv=60,endlv=120,},
        {tp="tp14",order=576,id=21432,num=1,note="item",startlv=10,endlv=40,},
        {tp="tp14",order=577,id=21433,num=1,note="item",startlv=20,endlv=49,},
        {tp="tp14",order=578,id=21434,num=1,note="item",startlv=30,endlv=59,},
        {tp="tp14",order=579,id=21435,num=1,note="item",startlv=40,endlv=69,},
        {tp="tp14",order=580,id=21436,num=1,note="item",startlv=50,endlv=79,},
        {tp="tp14",order=581,id=21436,num=1,note="item",startlv=60,endlv=120,},
        {tp="tp14",order=582,id=11672,num=1,note="item",startlv=30,endlv=59,},
        {tp="tp14",order=583,id=11673,num=1,note="item",startlv=40,endlv=120,},
        {tp="tp15",order=600,id=20321,num=1,note="item",startlv=40,endlv=120,},
        {tp="tp15",order=601,id=20322,num=1,note="item",startlv=40,endlv=120,},
        {tp="tp15",order=602,id=20325,num=1,note="item",startlv=40,endlv=120,},
        {tp="tp15",order=603,id=20328,num=1,note="item",startlv=40,endlv=120,},
        {tp="tp15",order=604,id=20329,num=1,note="item",startlv=40,endlv=120,},
        {tp="tp15",order=605,id=20330,num=1,note="item",startlv=40,endlv=120,},
        {tp="tp15",order=606,id=20344,num=1,note="item",startlv=40,endlv=120,},
        {tp="tp15",order=607,id=20345,num=1,note="item",startlv=40,endlv=120,},
        {tp="tp16",order=640,id=10874,id2=31936,num=1,note="task_item",startlv=10,endlv=200,},
        {tp="tp16",order=641,id=10875,id2=31937,num=1,note="task_item",startlv=30,endlv=200,},
        {tp="tp16",order=642,id=10876,id2=31963,num=1,note="task_item",startlv=40,endlv=200,},
        {tp="tp16",order=643,id=10877,id2=31954,num=1,note="task_item",startlv=40,endlv=200,},
        {tp="tp16",order=644,id=10878,id2=31938,num=1,note="task_item",startlv=50,endlv=200,},
        {tp="tp17",order=660,id=16955,num=1,note="item",startlv=40,endlv=120,},
        {tp="tp17",order=661,id=16956,num=1,note="item",startlv=40,endlv=120,},
        {tp="tp17",order=662,id=17010,num=1,note="item",startlv=40,endlv=120,},
        {tp="tp17",order=663,id=17014,num=1,note="item",startlv=40,endlv=120,},
        {tp="tp18",order=670,id=1,num=1,note="submit",startlv=50,endlv=69,},
        {tp="tp18",order=671,id=2,num=1,note="submit",startlv=70,endlv=90,},
    },

	submits =
	{
		[1] =
		{
			{ quality = 1, id = 17210,},--灵魂原石(熊)	白
			{ quality = 2, id = 17211,},--灵魂原石(熊)	绿
			{ quality = 1, id = 17229,},--灵魂原石(密林之友)	白
			{ quality = 2, id = 17230,},--灵魂原石(密林之友)	绿
			{ quality = 1, id = 17233,},--灵魂原石(蜘蛛)	白
			{ quality = 2, id = 17234,},--灵魂原石(蜘蛛)	绿
		},
		[2] =
		{
			{ quality = 1, id = 28249,},--灵魂原石(机关人)	白
			{ quality = 2, id = 28250,},--灵魂原石(机关人)	绿
			{ quality = 1, id = 28252,},--灵魂原石(矮人)	白
			{ quality = 2, id = 28253,},--灵魂原石(矮人)	绿
			{ quality = 1, id = 34230,},--灵魂原石(丛林黑豹)	白
			{ quality = 2, id = 34231,},--灵魂原石(丛林黑豹)	绿
		},
	},

	--以下是程序使用的表
	Property =
  	{
  		bCanRedo = true,
  		bCanRedoAfterFailure = true,
  		bCanGiveUp = true,
  		bShowPrompt = true,
  		bCanSeekOut = false,
  		bRecordFinishCount = true,
  		iMaxFinishCount = 30,		--每天最多可完成的次数：30
  		iClearFinishCountType = TaskClearFinishCountType.Daily,--每天清空
  		iType  = TaskType.LiLian,
  		iTopic = TaskTopic.YiBan,
  	},
	AwardPreview =
	{
		Exp = function(TASKINTERFACE_POINTER)
			local base_awards = { xp = 108, bindmoney = 10 }
			local multi = { 0.4,	0.54,	0.67,	0.8,	0.94,	1.07,	1.2,	1.34,	1.47,	1.6,}
			local completetimes = TaskCApi.GetTaskCompleteTimesFromFinishTimeTaskList(TASKINTERFACE_POINTER,9706)	--任务已经完成次数
			local idx = 1											--极效生活次数占用活动计数编号：1
			local commonCount = TaskCApi.GetCommonTaskCount(TASKINTERFACE_POINTER,idx)
			local playerLevel = TaskCApi.GetPlayerLevel(TASKINTERFACE_POINTER)
			local iExperience = TaskExpAdjust[playerLevel]		--根据玩家等级,从全局表里找到对应的等级经验系数
			local iBindMoneyNum = TaskMoneyAdjust[playerLevel]		--根据玩家等级,从全局表里找到对应的金钱经验系数
			local awardmulti
				--把任务次数折算成环数
			local step												--每1轮中的第几环（每10次算1轮，每轮中的第1次是第1环，依次类推）
			if	(completetimes + 1)  % 10 == 0 then
				step = 10
			else
				step = (completetimes + 1) % 10
			end
				--属于极效生活，则按环数递增；否则，按环数递增并且除以5
			if step == 0 then
				awardmulti = 0
			elseif commonCount >= 1 then
				awardmulti = multi[step]
			else
				awardmulti = multi[step]/5
			end

			iExperience = math.floor(iExperience * base_awards.xp * awardmulti)
			return iExperience	--返回0时为？？？,其他为显示的值
		end	,
		BindMoney = function(TASKINTERFACE_POINTER)
			local base_awards = { xp = 108, bindmoney = 10 }
			local multi = { 0.4,	0.54,	0.67,	0.8,	0.94,	1.07,	1.2,	1.34,	1.47,	1.6,}
			local levelRatio = 										--根据等级调整魂币奖励的倍率参数，递减
			{
				[1] = { lv = 0,   startRatio = 20,   stepRatio = 0 },
				[2] = { lv = 15,  startRatio = 20,   stepRatio = 0.64 },
				[3] = { lv = 35,  startRatio = 7.2,  stepRatio = 0.168 },
				[4] = { lv = 45,  startRatio = 5.52, stepRatio = 0.1 },
				[5] = { lv = 55,  startRatio = 4.52, stepRatio = 0.035 },
				[6] = { lv = 65,  startRatio = 4.17, stepRatio = 0.014 },
			}
			local completetimes = TaskCApi.GetTaskCompleteTimesFromFinishTimeTaskList(TASKINTERFACE_POINTER,9706)	--任务完成次数
			local idx = 1											--极效生活次数占用活动计数编号：1
			local commonCount = TaskCApi.GetCommonTaskCount(TASKINTERFACE_POINTER,idx)
			local playerLevel = TaskCApi.GetPlayerLevel(TASKINTERFACE_POINTER)
			local iExperience = TaskExpAdjust[playerLevel]			--根据玩家等级,从全局表里找到对应的等级经验系数
			local iBindMoneyNum = TaskMoneyAdjust[playerLevel]		--根据玩家等级,从全局表里找到对应的金钱经验系数
			local awardmulti = 0
				--按角色等级不同，算出等级调整倍率
			for k,v in ipairs(levelRatio) do
				if playerLevel > v.lv then
					awardmulti = v.startRatio - (playerLevel - v.lv) * v.stepRatio
				else
					break
				end
			end
				--把任务次数折算成环数
			local step												--每1轮中的第几环（每10次算1轮，每轮中的第1次是第1环，依次类推）
			if	(completetimes + 1)  % 10 == 0 then
				step = 10
			else
				step = (completetimes + 1) % 10
			end
				--属于极效生活，则按环数递增；否则，按环数递增并且除以5
			if step == 0 then
				awardmulti = 0
			elseif commonCount >= 1 then
				awardmulti = awardmulti * multi[step]
			else
				awardmulti = awardmulti * multi[step]/5
			end

			iBindMoneyNum = math.floor(iBindMoneyNum * base_awards.bindmoney * awardmulti)
			return iBindMoneyNum--返回0时为？？？,其他为显示的值
		end	,

		Items = function(TASKINTERFACE_POINTER)
			local items = {}
			local completetimes = TaskCApi.GetTaskCompleteTimesFromFinishTimeTaskList(TASKINTERFACE_POINTER,9706)	--任务完成次数
			items = {
						Item1 = {ID = 0, NUM = 1},--0时为？？？,其他显示物品和数量
					}
			if completetimes == 9 then
				items.Item1.ID = 2296
			end
			return items
		end,
	},

   	--任务发放检查,客户端在NPC显示、玩家确认接受时调用,服务器在响应发放时调用
   	OnCheckDeliver = function(TASKINTERFACE_POINTER)
		local player =	--取得玩家的一些数据
		{
			level = TaskCApi.GetPlayerLevel(TASKINTERFACE_POINTER),
		}
	   	if player.level < 10 then  return TASK_PREREQU_FAIL_LUA_TASK end		--需要等级至少为10级

		--任务栏是否已满
-- 		local iRet = TaskCApi.CheckDeliverNewTask(TASKINTERFACE_POINTER, 5719)	--能否在发放本任务的同时发放另一个任务（愿望-互斥）,预留空间
-- 		if iRet ~= 0 then
-- 			return TASK_PREREQU_FAIL_LUA_TASK
-- 		end


		--角色的当前任务列表里没有本任务的互斥任务：9823
		if TaskCApi.HasTaskInActiveTaskList(TASKINTERFACE_POINTER,9823) then return TASK_PREREQU_FAIL_LUA_TASK end
   		return 0
   	end
   	,

   	--玩家接收该任务时调用
   	OnDeliver = function(TASKINTERFACE_POINTER)
		local TPMAX = 20	--levelweight表里tp的最大值,现在是20
		local player =	--取得玩家的一些数据
		{
			level = TaskCApi.GetPlayerLevel(TASKINTERFACE_POINTER),
			race = TaskCApi.GetPlayerRace(TASKINTERFACE_POINTER),
			prof = TaskCApi.GetPlayerOccupation(TASKINTERFACE_POINTER),
			buff = 0,
			repu31 = TaskCApi.GetRegionReputation(TASKINTERFACE_POINTER,31),
		}

		local tpfinal = {}		--最终的任务形式从这个表里进行随机
		local levelnow,tpnow
		local peak = 0

		--确认从levelweight的哪一行取数
		local temp_level = 1
		while TaskList[9706].levelweight[temp_level+1] and player.level >= TaskList[9706].levelweight[temp_level+1].level do
			temp_level = temp_level+1
		end
		levelnow = temp_level

		--进行筛选
		math.randomseed(os.time())

			--根据每个tp的权重随机抽取,确认其中一个tp
			local iRam = math.random(1,1000)

			local j
			for j=1,TPMAX do
				if iRam > peak and iRam <= peak + (TaskList[9706].levelweight[levelnow]["tp"..j] or 0 ) then
					tpnow = j
					break
				end
				peak = peak + (TaskList[9706].levelweight[levelnow]["tp"..j] or 0 )

			end

			if j==TPMAX then tpnow = tpnow or 1 end	--容错：如果没有随到任何类型,那么就指定是tp1

			--根据startlv和endlv等条件,从tplib里筛选出符合条件的项,压入新表tpfinal
			for i,v in ipairs(TaskList[9706].tplib) do
				if v.id and v.tp == "tp"..tpnow then
					if v.startlv <= player.level and player.level <= v.endlv then
						if not v.race or player.race == v.race then
							if not v.prof or player.prof == v.prof then
								if not v.buff or player.buff == v.buff then
									table.insert(tpfinal,v)
								end
							end
						end
					end
				end
			end
			if not tpfinal[1] then
				tpfinal[1] = TaskList[9706].tplib[1]
			end

		--从tplib里随机抽取得到最终的order

		local iRam2 = math.random(1,#tpfinal)
		local ordernow = tonumber(tpfinal[iRam2].order)		--最终得到的order
		local notenow = tpfinal[iRam2].note		--最终得到的note,用于任务相关判断
		local idnow = tpfinal[iRam2].id		--最终得到的id,用于任务相关判断

		--------------------------------------------------测试gm-----------------------------------------------------
		local item2053 = TaskCApi.GetItemNumInPacket(TASKINTERFACE_POINTER,2053, true)
		if item2053 ~= 0 then
			for i,v in ipairs (TaskList[9706].tplib) do
				if item2053 == v.order then
					ordernow = item2053	--指定order
					notenow = v.note	--指定note
					idnow = v.id	--指定id
					break
				end
			end

		end
		-------------------------------------------------测试over----------------------------------------------------

		local x,y = math.floor(ordernow / 200), ordernow % 200				--把order拆成两个整数: order = 200*x + y
		TaskCApi.SetDataToActiveTaskList(TASKINTERFACE_POINTER,9706, 1,x)	--x,y分别存入任务变量1和2
		TaskCApi.SetDataToActiveTaskList(TASKINTERFACE_POINTER,9706, 2,y)

		--把#31声望清零,再把#31设成ordernow的值。#31声望是隐藏声望,用于判断是哪个附属任务能够被接到。
		--如果note="task" or "wish" or "task_item" or "site",那么清空任务完成次数,清除任务完成结果。


--		local taskid = {}
		if notenow == "task" or notenow == "wish" or notenow == "task_item"  or notenow == "site" then
--		local taskid = {9707,9708,9709,	9710,9711,9712,9713,9714,9715,9716,9717,9718,9719,9720,9721,9722,9723,9724,9725,9726,9791,5718,9727,9728,9729,}
			TaskCApi.DeliverRegionReputation(TASKINTERFACE_POINTER,31, ordernow - player.repu31)
			TaskCApi.ClearTaskCompleteTimesInFinishTimeTaskList(TASKINTERFACE_POINTER,idnow)
			TaskCApi.ClearFinishRecords(TASKINTERFACE_POINTER,idnow)
		end

		--如果是愿望任务（order=30）,那么发放一个立即完成的隐藏库任务5719,刷新任务库
		if ordernow == 30 then
			TaskCApi.DeliverNewTask(TASKINTERFACE_POINTER,5719)
		end
		--如果是提交物品，把物品组编号存入变量4，传给界面显示使用
		if notenow == "submit" then
			TaskCApi.SetDataToActiveTaskList(TASKINTERFACE_POINTER,9706, 4, idnow) --把所提交物品组号idnow存入任务变量4
		end
		return 0
	end
	,

   	--服务器杀怪、取得物品等条件下调用,客户端任务界面显示时调用
   	OnMethod = function(TASKINTERFACE_POINTER)
   		local Method = {}
		local final
		local x = TaskCApi.GetDataFromActiveTaskList(TASKINTERFACE_POINTER,9706, 1)
		local y = TaskCApi.GetDataFromActiveTaskList(TASKINTERFACE_POINTER,9706, 2)
		local ordernow = 200 * x + y
		--根据ordernow的值遍历tplib,找到索引号,存入变量final
		for i,v in ipairs(TaskList[9706].tplib) do
			if v.order == ordernow then
				final = i
				break
			end
		end
		--设定任务完成方式
		if TaskList[9706].tplib[final].note == "task" then
			Method.CompleteTask = {TaskID = TaskList[9706].tplib[final].id, Num = TaskList[9706].tplib[final].num}
		elseif TaskList[9706].tplib[final].note == "site" then
			Method.CompleteTask = {TaskID = TaskList[9706].tplib[final].id, Num = TaskList[9706].tplib[final].num}
		elseif TaskList[9706].tplib[final].note == "monster" then
			Method.KillMonster =
			{
				Mons1 =
				{
					ID = TaskList[9706].tplib[final].id,
					Num = TaskList[9706].tplib[final].num,
				},
			}
		elseif TaskList[9706].tplib[final].note == "mos_item" then
			Method.KillMonster =
			{
				Mons1 =
				{
					ID = TaskList[9706].tplib[final].id,
					Num = 0,
					DropItemID = TaskList[9706].tplib[final].id2,
					DropItemProbability = 0.5	--掉落物品概率统一为0.5
				},
			}
			Method.CollectItem =
			{
				Item1=
				{
					ID=TaskList[9706].tplib[final].id2,
					Num=TaskList[9706].tplib[final].num,
					Common=false
				},
			}
		elseif TaskList[9706].tplib[final].note == "item" then
			Method.CollectItem =
			{
				Item1=
				{
					ID=TaskList[9706].tplib[final].id,
					Num=TaskList[9706].tplib[final].num,
					Common=true
				},
			}
		elseif TaskList[9706].tplib[final].note == "wish" then	--愿望
			Method.CollectItem =
			{
				Item1=
				{
					ID=TaskList[9706].tplib[final].id2,
					Num=TaskList[9706].tplib[final].num,
					Common=true
				},
			}
		elseif TaskList[9706].tplib[final].note == "task_item" then	--特定任务给予普通物品
			Method.CollectItem =
			{
				Item1=
				{
					ID=TaskList[9706].tplib[final].id2,
					Num=TaskList[9706].tplib[final].num,
					Common=true
				},
			}
		elseif TaskList[9706].tplib[final].note == "submit" then	--提交特定物品
			Method.SubmitItem = true
		else
			Method.iWaitTime = 0
		end
   		return Method
   	end
   	,

   	--检查完成任务,在杀怪、拾取物品、每隔一定时间、发奖前调用
   	OnCheckFinish = function(TASKINTERFACE_POINTER)
   		local iRet = TASK_NO_FINISH
		local final
		local x = TaskCApi.GetDataFromActiveTaskList(TASKINTERFACE_POINTER,9706, 1)
		local y = TaskCApi.GetDataFromActiveTaskList(TASKINTERFACE_POINTER,9706, 2)
		local ordernow = 200 * x + y
		--根据ordernow的值遍历tplib,找到索引号,存入变量final
		for i,v in ipairs(TaskList[9706].tplib) do
			if v.order == ordernow then
				final = i
				break
			end
		end
		--设定任务完成方式：成功完成
		if TaskList[9706].tplib[final].note == "task" then
			local iCount = TaskCApi.GetTaskCompleteTimesFromFinishTimeTaskList(TASKINTERFACE_POINTER,TaskList[9706].tplib[final].id)
			if iCount >= 1 then
				iRet = TASK_SUCC_FINISH
			end
		elseif TaskList[9706].tplib[final].note == "site" then
			local iCount = TaskCApi.GetTaskCompleteTimesFromFinishTimeTaskList(TASKINTERFACE_POINTER,TaskList[9706].tplib[final].id)
			if iCount >= 1 then
				iRet = TASK_SUCC_FINISH
			end
		elseif TaskList[9706].tplib[final].note == "monster" then
			local iCount = TaskCApi.GetMonstersKilled(TASKINTERFACE_POINTER,9706, "Mons1")
			if iCount >= TaskList[9706].tplib[final].num then
				iRet = TASK_SUCC_FINISH
			end
		elseif TaskList[9706].tplib[final].note == "mos_item" then
			local iCount = TaskCApi.GetItemNumInPacket(TASKINTERFACE_POINTER,TaskList[9706].tplib[final].id2, false)	--id是怪物id,id2是任务物品id
			if iCount >= TaskList[9706].tplib[final].num then
				iRet = TASK_SUCC_FINISH
			end
		elseif TaskList[9706].tplib[final].note == "item" then
			local iCount = TaskCApi.GetItemNumInPacket(TASKINTERFACE_POINTER,TaskList[9706].tplib[final].id, true)
			if iCount >= TaskList[9706].tplib[final].num then
				iRet = TASK_SUCC_FINISH
			end
		elseif TaskList[9706].tplib[final].note == "wish" then
			local iCount = TaskCApi.GetItemNumInPacket(TASKINTERFACE_POINTER,TaskList[9706].tplib[final].id2, true)
			if iCount >= TaskList[9706].tplib[final].num then
				iRet = TASK_SUCC_FINISH
			end
		elseif TaskList[9706].tplib[final].note == "task_item" then
			local iCount = TaskCApi.GetItemNumInPacket(TASKINTERFACE_POINTER,TaskList[9706].tplib[final].id2, true)
			if iCount >= TaskList[9706].tplib[final].num then
				iRet = TASK_SUCC_FINISH
			end
		elseif TaskList[9706].tplib[final].note == "submit" then
			local itemIDSubmitted,itemNumberSubmitted = TaskCApi.GetSubmitItemInfo(TASKINTERFACE_POINTER,9706)
			local submitGroup = TaskList[9706].tplib[final].id	--取得提交物品组编号
			if itemIDSubmitted and itemNumberSubmitted then
				for k,v in ipairs(TaskList[9706].submits[submitGroup]) do
					if itemIDSubmitted == v.id and itemNumberSubmitted >= TaskList[9706].tplib[final].num then
						TaskCApi.SetDataToActiveTaskList(TASKINTERFACE_POINTER,9706, 3, k) --把所提交物品在submits[submitGroup]的索引号存入任务变量3
						iRet = TASK_SUCC_FINISH
						break
					elseif itemIDSubmitted == v.id and itemNumberSubmitted < TaskList[9706].tplib[final].num then
						TaskCApi.NotifySubmitItemErr(TASKINTERFACE_POINTER, 9706, 29, 20001)
						break
					end
					if k == #TaskList[9706].submits[submitGroup] then
						TaskCApi.NotifySubmitItemErr(TASKINTERFACE_POINTER, 9706, 29, 20000)
					end
				end
			end
		end
		--设定任务完成方式：失败完成(当附属任务失败完成时,主任务也失败）

--[[	TaskCApi.HasTaskInFinsihTaskList(TASKINTERFACE_POINTER,iTaskID,bSuccess) --玩家的完成任务列表FinishTaskList中是否有任务
					iTaskID		int		任务ID
					bSuccess	bool	为true表示任务iTaskID是成功完成,为false表示任务iTaskID是失败完成。

		if TaskCApi.HasTaskInFinsihTaskList(TASKINTERFACE_POINTER,TaskList[9706].tplib[final].id,false) then
			iRet = TASK_FAIL_FINISH
		end
--]]
   		return iRet
   	end
   	,

   	OnCheckAward = function(TASKINTERFACE_POINTER, bSuccess)
   		if bSuccess then
   	    	if TaskCApi.GetCommonPacketEmptySolts(TASKINTERFACE_POINTER)  < 1 then --普通包裹栏需要1格
   			   return TASK_PREREQU_FAIL_GIVEN_ITEM
			end
		end
   		return 0
   	end
   	,

   	--完成该任务时服务器调用
   	OnAward = function(TASKINTERFACE_POINTER, bSuccess,iParam,bRetrieve,ucRandomNum1,ucRandomNum2,ucRandomNum3)	--后3个参数是任务变量的值
		local final
		local player =	--取得玩家的一些数据
		{
			level = TaskCApi.GetPlayerLevel(TASKINTERFACE_POINTER),
			race = TaskCApi.GetPlayerRace(TASKINTERFACE_POINTER),
			prof = TaskCApi.GetPlayerOccupation(TASKINTERFACE_POINTER),
			buff = 0,
			repu31 = TaskCApi.GetRegionReputation(TASKINTERFACE_POINTER,31),
		}

		local x = ucRandomNum1
		local y = ucRandomNum2
		local submitIdx = ucRandomNum3
		local ordernow = 200 * x + y
		--根据ordernow的值遍历tplib,找到索引号,存入变量final
		for i,v in ipairs(TaskList[9706].tplib) do
			if v.order == ordernow then
				final = i
				break
			end
		end
		local notenow = TaskList[9706].tplib[final].note
		local idnow = TaskList[9706].tplib[final].id
		local id2now = TaskList[9706].tplib[final].id2

		--成功奖励
   		if bSuccess then

			--发放隐藏任务9766,记录每周的绝对次数
			TaskCApi.DeliverNewTask(TASKINTERFACE_POINTER,9766)

			--收取普通物品
			if notenow == "item" then
				TaskCApi.TakeAwayCommonItem(TASKINTERFACE_POINTER, idnow, TaskList[9706].tplib[final].num or 1)
			elseif notenow == "wish" then
				TaskCApi.TakeAwayCommonItem(TASKINTERFACE_POINTER, id2now, TaskList[9706].tplib[final].num or 1)
			elseif notenow == "task_item" then
				TaskCApi.TakeAwayCommonItem(TASKINTERFACE_POINTER, id2now, TaskList[9706].tplib[final].num or 1)
			elseif notenow == "mos_item" then
				TaskCApi.TakeAwayTaskItem(TASKINTERFACE_POINTER, id2now, TaskList[9706].tplib[final].num or 1)
			elseif notenow == "submit" then
				TaskCApi.TakeAwayCommonItem(TASKINTERFACE_POINTER, TaskList[9706].submits[idnow][submitIdx].id, TaskList[9706].tplib[final].num or 1)
			end

			--将31号声望清零,清除辅助任务的次数和完成记录结果
			TaskCApi.DeliverRegionReputation(TASKINTERFACE_POINTER,31, 0-player.repu31)
			if notenow == "task" or notenow == "wish" or notenow == "task_item"  or notenow == "site"  then
				TaskCApi.ClearTaskCompleteTimesInFinishTimeTaskList(TASKINTERFACE_POINTER,TaskList[9706].tplib[final].id)
				TaskCApi.ClearFinishRecords(TASKINTERFACE_POINTER,idnow)
			end

			--发放经验和魂币奖励
			local base_awards = { xp = 108, bindmoney = 10 }		--基础经验和魂币系数
			local multi = { 0.4,	0.54,	0.67,	0.8,	0.94,	1.07,	1.2,	1.34,	1.47,	1.6,}			--每环递增系数
			local levelRatio = 										--根据等级调整魂币奖励的倍率参数，递减
			{
				[1] = { lv = 0,   startRatio = 20,   stepRatio = 0 },
				[2] = { lv = 15,  startRatio = 20,   stepRatio = 0.64 },
				[3] = { lv = 35,  startRatio = 7.2,  stepRatio = 0.168 },
				[4] = { lv = 45,  startRatio = 5.52, stepRatio = 0.1 },
				[5] = { lv = 55,  startRatio = 4.52, stepRatio = 0.035 },
				[6] = { lv = 65,  startRatio = 4.17, stepRatio = 0.014 },
			}
			local submitRatio = 0.10								--【提交物品方式】提交高品质物品的经验提高百分比
			local completetimes = TaskCApi.GetTaskCompleteTimesFromFinishTimeTaskList(TASKINTERFACE_POINTER,9706)	--本任务完成次数
			local idx = 1											--极效生活次数占用活动计数编号：1
			local commonCount = TaskCApi.GetCommonTaskCount(TASKINTERFACE_POINTER,idx)
			local iExperience = TaskExpAdjust[player.level]			--根据玩家等级,从全局表里找到对应的等级经验系数
			local iBindMoneyNum = TaskMoneyAdjust[player.level]		--根据玩家等级,从全局表里找到对应的金钱经验系数
			local awardmultiExp	 = 1								--经验奖励增加的最终百分比参数
			local awardmultiMoney = 1								--魂币奖励增加的最终百分比参数
			local PlayerReturnPlus = 0.5	-- 老玩家回归buff加成

				--按角色等级不同，算出仅对于魂币的等级调整倍率
			for k,v in ipairs(levelRatio) do
				if player.level > v.lv then
					awardmultiMoney = v.startRatio - (player.level - v.lv) * v.stepRatio
				else
					break
				end
			end
				--把任务次数折算成环数
			local step												--每1轮中的第几环（每10次算1轮，每轮中的第1次是第1环，依次类推）
			if completetimes == 0 then
				step = 0
			elseif	completetimes % 10 == 0 then
				step = 10
			else
				step = completetimes % 10
			end
				--属于极效生活，则按环数递增；否则，按环数递增并且除以5
			if step == 0 then
				awardmultiExp = 0
				awardmultiMoney = 0
			elseif commonCount >= 1 then
				awardmultiExp = awardmultiExp * multi[step]
				awardmultiMoney = awardmultiMoney * multi[step]
				-- 如果有老玩家回归buff，则经验加成
				if TaskCApi.HasBuff(TASKINTERFACE_POINTER,2895) then
					awardmultiExp = awardmultiExp * (1+ PlayerReturnPlus)
				end
			else
				awardmultiExp = awardmultiExp * multi[step] / 5
				awardmultiMoney = awardmultiMoney * multi[step] / 5
			end
				--提交物品完成方式：提交高品质物品
			if notenow == "submit" and submitIdx > 0 and TaskList[9706].submits[idnow][submitIdx].quality > 1 then
				awardmultiExp = awardmultiExp * (1+submitRatio)
			end

			TaskCApi.DeliverExperience(TASKINTERFACE_POINTER,math.floor(iExperience * base_awards.xp * awardmultiExp))
			TaskCApi.DeliverBindMoney(TASKINTERFACE_POINTER,math.floor(iBindMoneyNum * base_awards.bindmoney * awardmultiMoney))
			TaskCApi.ModifyCommonTaskCount(TASKINTERFACE_POINTER,idx, -1)		--极效生活次数减去1

			--发放其他奖励
			local iSideOccupExp = 25		--社交家（32号副职业）经验25点
			local iItemID =		--奖励物品的列表,同时只允许奖励1个物品,因为OnCheckAward只判断了有一个包裹空格即可。
			{
				--id：物品id,num：物品数量,rand：（1,1000）的随机数 落在这个闭合区间内即可获得此物品奖励
				[1] = { id = 23396,	num = 1, rand_min = 1, rand_max = 20 },	--表情卷轴:挑衅者之脸
				[2] = { id = 40829,	num = 1, rand_min = 21, rand_max = 350 },	--福袋
				[3] = { id = 28825,	num = 1, rand_min = 351, rand_max = 370 },	--	28825	金砂
				[4] = { id = 28826,	num = 1, rand_min = 371, rand_max = 390 },	--	28826	钻石原石
				[9999] =  { id = 2296,	num = 1, rand_min = 1, rand_max = 1000 },	--	2296	谜之笛				--100%在第10次任务时奖励
			}
			math.randomseed(os.time())
			local iRam = math.random(1,1000)

			--如果是里奥的愿望任务,发放社交家（32号副职业）经验25点,随机发放表情卷轴
			if ordernow == 30 then
				TaskCApi.DeliverSideOccupExp (TASKINTERFACE_POINTER, 32, iSideOccupExp )
				if iRam <= iItemID[1].rand_max  and completetimes ~= 10 then
					TaskCApi.DeliverCommonItem(TASKINTERFACE_POINTER,iItemID[1].id,iItemID[1].num,false)
				end
			end
			--完成第10次必得谜之笛x1,绑定
			if completetimes == 10 then
				TaskCApi.DeliverCommonItem(TASKINTERFACE_POINTER,iItemID[9999].id,iItemID[9999].num,true)
			else
				--等级30级以上给予物品奖励
				if player.level >= 30 then
--[[				--等级30级以上,每天第7\8\9次的时候分别有33%的几率出福袋,绑定
					if completetimes == 7 or completetimes == 8 or completetimes == 9 then
						if iRam >= iItemID[2].rand_min and iRam <= iItemID[2].rand_max then
							TaskCApi.DeliverCommonItem(TASKINTERFACE_POINTER,iItemID[2].id,iItemID[2].num,true)
						end
					end
--]]
				--等级30级以上,每天每次有0.02的几率出	金砂
					if iRam >= iItemID[3].rand_min and iRam <= iItemID[3].rand_max then
						TaskCApi.DeliverCommonItem(TASKINTERFACE_POINTER,iItemID[3].id,iItemID[3].num,false)
					end
				--等级30级以上,每天每次有0.02的几率出	钻石原石
					if iRam >= iItemID[4].rand_min and iRam <= iItemID[4].rand_max then
						TaskCApi.DeliverCommonItem(TASKINTERFACE_POINTER,iItemID[4].id,iItemID[4].num,false)
					end
				end
			end

			--每天第10次完成时有几率发放称号
			if completetimes == 10 then
				local TitleTask = --发称号的任务id和概率
				{
					[1] = {id = 9916, rand = 20},
					[2] = {id = 9917, rand = 5},
					[3] = {id = 9918, rand = 1},
				}
				math.randomseed(os.time())
				local iRam = math.random(1,100)
				if TaskCApi.GetTaskCompleteTimesFromFinishTimeTaskList(TASKINTERFACE_POINTER,TitleTask[1].id) >= 1 then
					if TaskCApi.GetTaskCompleteTimesFromFinishTimeTaskList(TASKINTERFACE_POINTER,TitleTask[2].id) >= 1 then
						if TaskCApi.GetTaskCompleteTimesFromFinishTimeTaskList(TASKINTERFACE_POINTER,TitleTask[3].id) >= 1 then
						elseif iRam <= TitleTask[3].rand then
							TaskCApi.DeliverNewTask(TASKINTERFACE_POINTER,TitleTask[3].id)
						end
					elseif  iRam <= TitleTask[2].rand then
						TaskCApi.DeliverNewTask(TASKINTERFACE_POINTER,TitleTask[2].id)
					end
				elseif  iRam <= TitleTask[1].rand then
					TaskCApi.DeliverNewTask(TASKINTERFACE_POINTER,TitleTask[1].id)
				end
			end
			--给予每周活跃度
			local WeeklyActivityTaskID = 13122
			if commonCount > 0 then
				TaskCApi.ModifyTaskFinishCnt(TASKINTERFACE_POINTER, WeeklyActivityTaskID, 1)
				TaskCApi.Broadcast(TASKINTERFACE_POINTER ,9706, 7)
				TaskCApi.DeliverRegionReputation(TASKINTERFACE_POINTER,36,1)
			end
		--失败奖励
		else
		--收取mos_item类型任务的任务物品,31号声望清零,清除辅助任务的次数和完成记录结果
			if notenow == "mos_item" then
				TaskCApi.TakeAwayTaskItem(TASKINTERFACE_POINTER, TaskList[9706].tplib[final].id2, TaskList[9706].tplib[final].num or 1)
			end
			TaskCApi.DeliverRegionReputation(TASKINTERFACE_POINTER,31, 0-player.repu31)
			if notenow == "task"  or notenow == "wish"  or notenow == "task_item"  or notenow == "site" then
				TaskCApi.ClearTaskCompleteTimesInFinishTimeTaskList(TASKINTERFACE_POINTER,TaskList[9706].tplib[final].id)
				TaskCApi.ClearFinishRecords(TASKINTERFACE_POINTER,TaskList[9706].tplib[final].id)
			end
		--发放主任务的互斥任务9823
			TaskCApi.DeliverNewTask(TASKINTERFACE_POINTER,9823)
		--发放记录每天失败次数的任务10059
			TaskCApi.DeliverNewTask(TASKINTERFACE_POINTER,10059)
   		end

   		return 0
   	end
}

TaskList[10117] = --活动：元宝换金发奖励脚本

{
	AwardPreview = {}
	,
	Property =
  	{
		bHiddenTask = true,
		bCanRedo = true,
  		bCanRedoAfterFailure = true,

  		bCanGiveUp = true,

  		bShowPrompt = false,
  		bCanSeekOut = false,
  		bFinishWhenDelvier = true,	--接受即完成！

  		bRecordFinishCount = true,
  		iMaxFinishCount = 9999,		--每天最多可完成的次数：100  -- 加保险
  		iClearFinishCountType = TaskClearFinishCountType.Daily,--每天清空

  		iType  = TaskType.JiangLi,
  		iTopic = TaskTopic.YiBan,
  	}
   	,

   	--任务发放检查,客户端在NPC显示、玩家确认接受时调用,服务器在响应发放时调用
   	OnCheckDeliver = function(TASKINTERFACE_POINTER)
	    local iPlayerLev = TaskCApi.GetPlayerLevel(TASKINTERFACE_POINTER)

	   	if iPlayerLev < 30 then
	   	    return TASK_PREREQU_FAIL_LUA_TASK
	   	end

   	    if TaskCApi.GetCommonPacketEmptySolts(TASKINTERFACE_POINTER)  < 1 then --普通包裹栏需要1格
   		   return TASK_PREREQU_FAIL_GIVEN_ITEM
		end

   		return 0
   	end
   	,

   	--玩家接收该任务时调用
   	OnDeliver = function(TASKINTERFACE_POINTER)

		return 0
	end
	,

   	--服务器杀怪、取得物品等条件下调用,客户端任务界面显示时调用
   	OnMethod = function(TASKINTERFACE_POINTER)
   		local Method = {}
   		Method.iWaitTime = 0

   		return Method
   	end
   	,

   	--检查完成任务,在杀怪、拾取物品、每隔一定时间、发奖前调用
   	OnCheckFinish = function(TASKINTERFACE_POINTER)
   		local iRet = TASK_NO_FINISH
   		iRet = TASK_SUCC_FINISH

		local ulCurTime     = TaskCApi.GetCurTime(TASKINTERFACE_POINTER)
   		local ulDeliverTime = TaskCApi.GetTaskDeliverTime(TASKINTERFACE_POINTER, 10117)
   		if ulCurTime - ulDeliverTime > 60 then
   		    iRet = TASK_FAIL_FINISH
   		end

   		return iRet
   	end
   	,

   	OnCheckAward = function(TASKINTERFACE_POINTER, bSuccess)
   		if bSuccess then
   	    	local iRet = TaskCApi.GetCommonPacketEmptySolts(TASKINTERFACE_POINTER) --普通包裹栏需要1格
			if iRet < 1 then
			    return TASK_PREREQU_FAIL_GIVEN_ITEM
			end
   		end

   		return 0
   	end
   	,

   	--完成该任务时服务器调用
   	OnAward = function(TASKINTERFACE_POINTER, bSuccess)
		local item_id = --物品id列表,rand（随机几率）满值是10000
		{
			[1] = { id = 28823, num = 1, rand = 50,},   --贤者之石
			[2] = { id = 12412, num = 1, rand = 800,},   --墨丘利点券
			[3] = { id = 14187, num = 5, rand = 1000,},   --微光的星辰碎片
			[4] = { id = 22905, num = 5, rand = 1000,},   --聚能的星辰碎片
			[5] = { id = 14188, num = 1, rand = 25,},   --星辰结晶
			[6] = { id = 19130, num = 1, rand = 112,},   --生命宝石1级
			[7] = { id = 19135, num = 1, rand = 140,},   --魔法宝石1级
			[8] = { id = 19140, num = 1, rand = 105,},   --攻击宝石1级
			[9] = { id = 19145, num = 1, rand = 140,},   --防御宝石1级
			[10] = { id = 20290, num = 1, rand = 63,},   --命中宝石1级
			[11] = { id = 20295, num = 1, rand = 63,},   --闪躲宝石1级
			[12] = { id = 20300, num = 1, rand = 14,},   --暴击宝石1级
			[13] = { id = 20305, num = 1, rand = 35,},   --暴伤宝石1级
			[14] = { id = 20310, num = 1, rand = 14,},   --免暴击宝石1级
			[15] = { id = 20315, num = 1, rand = 14,},   --减暴伤宝石1级
			[16] = { id = 2296, num = 3, rand = 500,},   --谜之笛
		}
		local gold_coin =  --金币奖励列表,rand（随机几率）满值是10000
		{
			{ rand = 530, gold = 48000,},   -- 4.8金
			{ rand = 530, gold = 48500,},   -- 4.85金
			{ rand = 530, gold = 48800,},   -- 4.88金
			{ rand = 530, gold = 49000,},   -- 4.9金
			{ rand = 530, gold = 49300,},   -- 4.93金
			{ rand = 530, gold = 49500,},   -- 4.95金
			{ rand = 530, gold = 49800,},   -- 4.98金
			{ rand = 5000, gold = 50000,},   -- 5金
			{ rand = 300, gold = 51600,},   -- 5.16金
			{ rand = 220, gold = 53100,},   -- 5.31金
			{ rand = 180, gold = 54600,},   -- 5.46金
			{ rand = 140, gold = 56100,},   -- 5.61金
			{ rand = 100, gold = 57500,},   -- 5.75金
			{ rand = 90, gold = 58900,},   -- 5.89金
			{ rand = 80, gold = 60200,},   -- 6.02金
			{ rand = 70, gold = 61500,},   -- 6.15金
			{ rand = 60, gold = 62800,},   -- 6.28金
			{ rand = 50, gold = 64000,},   -- 6.4金
		}
		local player =
		{
			level = TaskCApi.GetPlayerLevel(TASKINTERFACE_POINTER),
		}

--		直接产金几率 =	91.5%
--		贤者之石几率 =	0.5%
--		墨丘利点券几率 =	8.0% ,一次给 6 张
--		如果随到直接产金,那么从3号到16号物品中再随出一个物品,最多出1种物品
----
		if bSuccess then
			math.randomseed(os.time())
			local iRandomNum = math.random(1,10000)
			local item_rand_floor = 0	--物品概率区间下限
			local gold_rand_floor = 0	--金币概率区间下限
			local iOnlyItem = 0		--0（缺省值）：不奖励贤者之石或墨丘利点券,随机给金币；
									--1：仅奖励贤者之石 或 墨丘利点券+5金

			--发放物品奖励,贤者之石和墨丘利点券不绑定,其他物品绑定！
			for i,v in ipairs(item_id) do
				if iRandomNum > item_rand_floor and iRandomNum <= item_id[i].rand + item_rand_floor then
					--奖励贤者之石
					if i==1 then
						TaskCApi.DeliverCommonItem(TASKINTERFACE_POINTER,item_id[i].id, item_id[i].num , false)
						iOnlyItem = 1

					--等级35级以上,奖励墨丘利点券 + 5金
					elseif i==2 and player.level >= 35 then
						TaskCApi.DeliverCommonItem(TASKINTERFACE_POINTER,item_id[i].id, item_id[i].num , false)
						TaskCApi.DeliverGold(TASKINTERFACE_POINTER,50000)	--5金
						TaskCApi.DeliverBindMoney(TASKINTERFACE_POINTER,50000)	--2013.03.16 发同等量的魂币
						iOnlyItem = 1

					--等级40以下才发微光碎片
					elseif i==3 and player.level < 40 then
						TaskCApi.DeliverCommonItem(TASKINTERFACE_POINTER,item_id[i].id, item_id[i].num , true)

					--等级40以上才发聚能碎片
					elseif i==4 and player.level >= 40 then
						TaskCApi.DeliverCommonItem(TASKINTERFACE_POINTER,item_id[i].id, item_id[i].num , true)

					--其他
					elseif i > 4 then
						TaskCApi.DeliverCommonItem(TASKINTERFACE_POINTER,item_id[i].id, item_id[i].num , true)
					end
					break
				end
				item_rand_floor = item_id[i].rand + item_rand_floor
			end

			--如果不给贤者之石或者墨丘利点券,那么就发金币
			local iRandomNum2 = math.random(1,10000)

			if iOnlyItem == 0 then --如果不给贤者之石或者墨丘利点券
				for i,v in ipairs(gold_coin) do
					if iRandomNum2 > gold_rand_floor and iRandomNum2 <= gold_coin[i].rand + gold_rand_floor then
						TaskCApi.DeliverGold(TASKINTERFACE_POINTER,gold_coin[i].gold)
						TaskCApi.DeliverBindMoney(TASKINTERFACE_POINTER,gold_coin[i].gold)	--2013.03.16 发同等量的魂币
						break
					end
				gold_rand_floor = gold_coin[i].rand + gold_rand_floor
				end
			end
			--累计次数统计
			TaskCApi.ModifyTaskFinishCnt(TASKINTERFACE_POINTER, 14014, 1)

   		end

   		return 0
   	end
}

TaskList[12590] = --活动：元宝换金发奖励脚本【55级以上】【大】

{
	AwardPreview = {}
	,
	Property =
  	{
		bHiddenTask = true,
		bCanRedo = true,
  		bCanRedoAfterFailure = true,

  		bCanGiveUp = true,

  		bShowPrompt = false,
  		bCanSeekOut = false,
  		bFinishWhenDelvier = true,	--接受即完成！

  		bRecordFinishCount = true,
  		iMaxFinishCount = 9999,		--每天最多可完成的次数：100  -- 加保险
  		iClearFinishCountType = TaskClearFinishCountType.Daily,--每天清空

  		iType  = TaskType.JiangLi,
  		iTopic = TaskTopic.YiBan,
  	}
   	,

   	--任务发放检查,客户端在NPC显示、玩家确认接受时调用,服务器在响应发放时调用
   	OnCheckDeliver = function(TASKINTERFACE_POINTER)
	    local iPlayerLev = TaskCApi.GetPlayerLevel(TASKINTERFACE_POINTER)

	   	if iPlayerLev < 55 then
	   	    return TASK_PREREQU_FAIL_LUA_TASK
	   	end

   	    if TaskCApi.GetCommonPacketEmptySolts(TASKINTERFACE_POINTER)  < 1 then --普通包裹栏需要1格
   		   return TASK_PREREQU_FAIL_GIVEN_ITEM
		end

   		return 0
   	end
   	,

   	--玩家接收该任务时调用
   	OnDeliver = function(TASKINTERFACE_POINTER)

		return 0
	end
	,

   	--服务器杀怪、取得物品等条件下调用,客户端任务界面显示时调用
   	OnMethod = function(TASKINTERFACE_POINTER)
   		local Method = {}
   		Method.iWaitTime = 0

   		return Method
   	end
   	,

   	--检查完成任务,在杀怪、拾取物品、每隔一定时间、发奖前调用
   	OnCheckFinish = function(TASKINTERFACE_POINTER)
   		local iRet = TASK_NO_FINISH
   		iRet = TASK_SUCC_FINISH

		local ulCurTime     = TaskCApi.GetCurTime(TASKINTERFACE_POINTER)
   		local ulDeliverTime = TaskCApi.GetTaskDeliverTime(TASKINTERFACE_POINTER, 12590)
   		if ulCurTime - ulDeliverTime > 60 then
   		    iRet = TASK_FAIL_FINISH
   		end

   		return iRet
   	end
   	,

   	OnCheckAward = function(TASKINTERFACE_POINTER, bSuccess)
   		if bSuccess then
   	    	local iRet = TaskCApi.GetCommonPacketEmptySolts(TASKINTERFACE_POINTER) --普通包裹栏需要1格
			if iRet < 1 then
			    return TASK_PREREQU_FAIL_GIVEN_ITEM
			end
   		end

   		return 0
   	end
   	,

   	--完成该任务时服务器调用
   	OnAward = function(TASKINTERFACE_POINTER, bSuccess)
		local item_id = --物品id列表,rand（随机几率）满值是10000
		{
			[1] = { id = 28823, num = 1, rand = 50,},   --贤者之石
			[2] = { id = 12412, num = 1, rand = 800,},   --【墨丘利点券x1】
			[3] = { id = 14187, num = 5, rand = 1000,},   --微光的星辰碎片
			[4] = { id = 22905, num = 5, rand = 1000,},   --聚能的星辰碎片
			[5] = { id = 14188, num = 1, rand = 25,},   --星辰结晶
			[6] = { id = 19130, num = 1, rand = 112,},   --生命宝石1级
			[7] = { id = 19135, num = 1, rand = 140,},   --魔法宝石1级
			[8] = { id = 19140, num = 1, rand = 105,},   --攻击宝石1级
			[9] = { id = 19145, num = 1, rand = 140,},   --防御宝石1级
			[10] = { id = 20290, num = 1, rand = 63,},   --命中宝石1级
			[11] = { id = 20295, num = 1, rand = 63,},   --闪躲宝石1级
			[12] = { id = 20300, num = 1, rand = 14,},   --暴击宝石1级
			[13] = { id = 20305, num = 1, rand = 35,},   --暴伤宝石1级
			[14] = { id = 20310, num = 1, rand = 14,},   --免暴击宝石1级
			[15] = { id = 20315, num = 1, rand = 14,},   --减暴伤宝石1级
			[16] = { id = 2296, num = 3, rand = 500,},   --谜之笛
		}
		local gold_coin =  --金币奖励列表,rand（随机几率）满值是10000
		{
			{ rand = 530, gold = 48000,},   -- 4.8金
			{ rand = 530, gold = 48500,},   -- 4.85金
			{ rand = 530, gold = 48800,},   -- 4.88金
			{ rand = 530, gold = 49000,},   -- 4.9金
			{ rand = 530, gold = 49300,},   -- 4.93金
			{ rand = 530, gold = 49500,},   -- 4.95金
			{ rand = 530, gold = 49800,},   -- 4.98金
			{ rand = 5000, gold = 50000,},   -- 5金
			{ rand = 300, gold = 51600,},   -- 5.16金
			{ rand = 220, gold = 53100,},   -- 5.31金
			{ rand = 180, gold = 54600,},   -- 5.46金
			{ rand = 140, gold = 56100,},   -- 5.61金
			{ rand = 100, gold = 57500,},   -- 5.75金
			{ rand = 90, gold = 58900,},   -- 5.89金
			{ rand = 80, gold = 60200,},   -- 6.02金
			{ rand = 70, gold = 61500,},   -- 6.15金
			{ rand = 60, gold = 62800,},   -- 6.28金
			{ rand = 50, gold = 64000,},   -- 6.4金
		}
		local player =
		{
			level = TaskCApi.GetPlayerLevel(TASKINTERFACE_POINTER),
		}

--		直接产金几率 =	91.5%
--		贤者之石几率 =	0.5%
--		墨丘利点券几率 =	8.0% ,一次给 3 张 + 3金
--		如果随到直接产金,那么从3号到16号物品中再随出一个物品,最多出1种物品
----
		if bSuccess then
			math.randomseed(os.time())
			local iRandomNum = math.random(1,10000)
			local item_rand_floor = 0	--物品概率区间下限
			local gold_rand_floor = 0	--金币概率区间下限
			local iOnlyItem = 0		--0（缺省值）：不奖励贤者之石或墨丘利点券,给金币；
									--1：仅奖励贤者之石没有金币，或，【墨丘利点券+5金币】

			--发放物品奖励,贤者之石和墨丘利点券不绑定,其他物品绑定！
			for i,v in ipairs(item_id) do
				if iRandomNum > item_rand_floor and iRandomNum <= item_id[i].rand + item_rand_floor then
					--奖励贤者之石
					if i==1 then
						TaskCApi.DeliverCommonItem(TASKINTERFACE_POINTER,item_id[i].id, item_id[i].num , false)
						iOnlyItem = 1

					--等级35级以上,奖励【墨丘利点券+5金币】
					elseif i==2 and player.level >= 35 then
						TaskCApi.DeliverCommonItem(TASKINTERFACE_POINTER,item_id[i].id, item_id[i].num , false)
						TaskCApi.DeliverGold(TASKINTERFACE_POINTER,50000)	--5金
						TaskCApi.DeliverBindMoney(TASKINTERFACE_POINTER,50000)	--2013.03.16 发同等量的魂币
						iOnlyItem = 1

					--等级40以下才发微光碎片
					elseif i==3 and player.level < 40 then
						TaskCApi.DeliverCommonItem(TASKINTERFACE_POINTER,item_id[i].id, item_id[i].num , true)

					--等级40以上才发聚能碎片
					elseif i==4 and player.level >= 40 then
						TaskCApi.DeliverCommonItem(TASKINTERFACE_POINTER,item_id[i].id, item_id[i].num , true)

					--其他
					elseif i > 4 then
						TaskCApi.DeliverCommonItem(TASKINTERFACE_POINTER,item_id[i].id, item_id[i].num , true)
					end
					break
				end
				item_rand_floor = item_id[i].rand + item_rand_floor
			end

			--如果不给贤者之石或者墨丘利点券,那么就发金币
			local iRandomNum2 = math.random(1,10000)

			if iOnlyItem == 0 then --如果不给贤者之石或者墨丘利点券
				for i,v in ipairs(gold_coin) do
					if iRandomNum2 > gold_rand_floor and iRandomNum2 <= gold_coin[i].rand + gold_rand_floor then
						TaskCApi.DeliverGold(TASKINTERFACE_POINTER,gold_coin[i].gold)
						TaskCApi.DeliverBindMoney(TASKINTERFACE_POINTER,gold_coin[i].gold)	--2013.03.16 发同等量的魂币
						break
					end
				gold_rand_floor = gold_coin[i].rand + gold_rand_floor
				end
			end

			--累计次数统计
			TaskCApi.ModifyTaskFinishCnt(TASKINTERFACE_POINTER, 14014, 1)
   		end

   		return 0
   	end
}

